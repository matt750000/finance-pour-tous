{% extends "base.html.twig" %}

{% block title %}
	Produits
{% endblock %}

{% block body %}
	<div class="container" style="max-width: 70%; margin: auto;">
		<h2 class="text-center text-primary mb-4" style="font-weight: 700;">‚ú® Nos Produits ‚ú®</h2>

		<form method="get" class="mb-4 d-flex flex-wrap align-items-center justify-content-between" style="gap: 0.5rem;">
			<input type="text" name="q" value="{{ search|default('') }}" placeholder="Rechercher un produit..." class="form-control" style="flex: 2; min-width: 200px;"/>

			<select name="category" class="form-select" style="flex: 1; min-width: 180px;">
				<option value="">Toutes les cat√©gories</option>
				{% for cat in categories %}
					<option value="{{ cat.id }}" {% if selectedCategory is defined and selectedCategory == cat.id %} selected {% endif %}>
						{{ cat.name }}
					</option>
				{% endfor %}
			</select>

			<div class="d-flex" style="gap: 0.5rem;">
				<button type="submit" class="btn btn-primary">üîç Rechercher</button>
				<a href="{{ path('app_products') }}" class="btn btn-outline-secondary">‚ùå R√©initialiser</a>
			</div>
		</form>


		<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
			{% for product in products %}
				<div class="col">
					<div class="card h-100 shadow-sm" style="transform: scale(0.8);">
						{% if product.image %}
							<img src="{{ asset('images/products/' ~ product.image) }}" class="card-img-top" alt="{{ product.name }}">
						{% else %}
							<img src="{{ asset('images/default-product.jpg') }}" class="card-img-top" alt="Image par d√©faut">
						{% endif %}
						<div class="card-body">
							<h5 class="card-title">{{ product.name }}</h5>
							<p class="card-text text-muted">
								{{ product.description|default('Aucune description')|slice(0, 100) ~ '...' }}
							</p>
						</div>
						<div class="card-footer d-flex justify-content-between align-items-center">
							<span class="fw-bold">{{ product.price }}
								‚Ç¨</span>
							<a href="{{ path('add_to_cart', { id: product.id }) }}" class="btn btn-success btn-sm">
								üõí Ajouter au panier
							</a>

						</div>
					</div>
				</div>
			{% else %}
				<div class="col">
					<div class="alert alert-info">Aucun produit trouv√©.</div>
				</div>
			{% endfor %}
		</div>

		<div class="navigation d-flex justify-content-center mt-4">
			{{ knp_pagination_render(products) }}
		</div>
	</div>

{% endblock %}
